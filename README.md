[![Build Status](https://travis-ci.org/tigersoldier/JavaComp.svg)](https://travis-ci.org/tigersoldier/JavaComp)

# JavaComp - a Java Language Server

JavaComp implements [Language Server Protocol][lang-server] for Java language.
It provides language editing features such as code completion, showing method
signatures and jumping to definitions to editors that support the protocol.

## Features

### Code completion

![Code completion screencast][completion-screencast]

### Go to definition

![Go to definition screencast][definition-screencast]

### Symbol documentation

![Symbol documentation screencast][hover-screencast]


## How to install

See the installation guide for your editor:

 * Emacs: [javacomp-el][javacomp-el]
 * Visual Studio Code: [javacomp-vscode][javacomp-vscode]

## Customization

Editor plugins can customize the behavior of JavaComp by setting the
`initializationOptions` field of of the [`initialize`
Request][initialize-request]. Consult the documentation of the editor for how to
set them in your editor.

Below is supported options. The source of truth of the supported options is the
`InitializationOptions` class defined in
[InitializeParams.java][InitializeParams.java].

### logPath

(String) Path of the log file. If not set, logs are not written to any file.

### logLevel

(String) The minimum log level. Logs with the level and above will be logged.

Possible values are: `severe`, `warning`, `info`, `fine`, `finer`, `finest`.

### ignorePaths

(String) Pattern of paths that JavaComp should ignore.

The patterns are valid Java path glob patterns defined by the documentation of
`java.nio.file.FileSystem#getPathMatcher` without `glob:` prefix.
     
When determing whether a path of a file or directory should be ignored, the path
is converted into 2 froms: the filename and pseudo absolute path. A pseudo
absolute path is the path without the prefix of project root path. For example,
if a path is `/root/path/foo/bar` and the project root path is `/root/path`, its
pseudo absolute path is `/foo/bar`. If a path is not under project root, its
pseudo absolute path is itself.
     
Both filename of the path and its pseudo absolute path are checked by all ignore path
patterns. If either form matches any of the patterns, the path is ignored.

### typeIndexFiles

(Array of strings) A list of file paths that contains additional type indeces
generated by the Indexer tool.

The path can be either relative to the project root path, or an absolute path.

## Development

### Prerequisite

You need to install the following softwares for building JavaComp from source
code:

 * JDK 8 or above
 * [Bazel][bazel]

### Build the jar

To build the jar, `cd` to the directory of the source code, then build it with
the `bazel build` command:

```bash
bazel build //src/main/java/org/javacomp/server:JavaComp_deploy.jar
```

The jar file is available at
`bazel-bin/src/main/java/org/javacomp/server/JavaComp_deploy.jar`

### Run tests

To run all tests, use the `bazel test` command:

```bash
bazel test ... -k
```

The `-k` option allows skipping failed tests.

### Code style

JavaComp follows [Google Java Style][google-java-style].

Use the [Google Java format][google-java-format] tool to format the Java code.
The [fix-format.sh](#fix-formatsh) script can help formatting all changed .java
files.

### Tools

Several tools are available for helping development.

#### fix-format.sh

This script can fix the code styles for .java files and BUILD files. It requires
the following tools:

 * [Google Java format][google-java-format]
 * [buidifier][buildifier]

To run it, `cd` to the repository root directory and run

```bash
script/fix-format.sh -f -c
```

[lang-server]: https://github.com/Microsoft/language-server-protocol
[initialize-request]: https://github.com/Microsoft/language-server-protocol/blob/master/protocol.md#initialize-request
[InitializeParams.java]: https://github.com/tigersoldier/JavaComp/blob/develop/src/main/java/org/javacomp/server/protocol/InitializeParams.java
[javacomp-el]: https://github.com/tigersoldier/javacomp-el
[javacomp-vscode]: https://github.com/tigersoldier/javacomp-vscode
[completion-screencast]: https://user-images.githubusercontent.com/226229/31046835-b3a36ba8-a632-11e7-8cd5-d53da7c6a638.gif
[definition-screencast]: https://user-images.githubusercontent.com/226229/31046836-b3c26166-a632-11e7-8601-8c4f368f3f37.gif
[hover-screencast]: https://user-images.githubusercontent.com/226229/31046837-b3c2f220-a632-11e7-84c1-d04260a9ac3d.gif
[bazel]: https://bazel.build/
[buildifier]: https://github.com/bazelbuild/buildtools
[google-java-format]: https://github.com/google/google-java-format
[google-java-style]: https://google.github.io/styleguide/javaguide.html
